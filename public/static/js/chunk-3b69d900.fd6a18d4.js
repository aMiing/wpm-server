(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b69d900"],{"466d":function(e,t,n){"use strict";var a=n("c65b"),r=n("d784"),i=n("825a"),s=n("50c4"),c=n("577e"),o=n("1d80"),l=n("dc4a"),u=n("8aa5"),d=n("14c3");r("match",(function(e,t,n){return[function(t){var n=o(this),r=void 0==t?void 0:l(t,e);return r?a(r,t,n):new RegExp(t)[e](c(n))},function(e){var a=i(this),r=c(e),o=n(t,a,r);if(o.done)return o.value;if(!a.global)return d(a,r);var l=a.unicode;a.lastIndex=0;var f,p=[],v=0;while(null!==(f=d(a,r))){var h=c(f[0]);p[v]=h,""===h&&(a.lastIndex=u(r,s(a.lastIndex),l)),v++}return 0===v?null:p}]}))},"7e12":function(e,t,n){var a=n("da84"),r=n("d039"),i=n("e330"),s=n("577e"),c=n("58a8").trim,o=n("5899"),l=i("".charAt),u=a.parseFloat,d=a.Symbol,f=d&&d.iterator,p=1/u(o+"-0")!==-1/0||f&&!r((function(){u(Object(f))}));e.exports=p?function(e){var t=c(s(e)),n=u(t);return 0===n&&"-"==l(t,0)?-0:n}:u},"81ff":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"reception"},[n("div",{staticClass:"vab-main"},[n("div",{staticClass:"fixed-header"},[n("vab-nav-bar",{attrs:{mode:"simple"}})],1),n("div",{staticClass:"top-menu"},e._l(e.topMenuList,(function(t,a){return n("div",{key:a,staticClass:"menu-content",on:{click:function(n){return e.handleClickMenu(t)}}},[n("vab-icon",{attrs:{icon:["fas",t.icon]}}),n("span",{staticClass:"menu-name"},[e._v(" "+e._s(t.name)+" ")])],1)})),0),n("vab-ad")],1),n("div",{staticClass:"reception-main"},[n("div",{staticClass:"cart-content"},[n("cart",{staticClass:"hidden-xs-only"})],1),n("div",{staticClass:"goods-content"},[n("div",{staticClass:"tab-content"},[n("el-tabs",{attrs:{type:"card"},model:{value:e.activeTypeId,callback:function(t){e.activeTypeId=t},expression:"activeTypeId"}},e._l(e.allTypes,(function(t,a){return n("el-tab-pane",{key:a,attrs:{label:t.name,name:t.uuid}},[n("div",{staticClass:"tab-panne-content"},[(e.dataByType[e.activeTypeId]||[]).length?n("el-row",{attrs:{gutter:20}},e._l(e.dataByType[e.activeTypeId],(function(t){return n("el-col",{key:t.uuid,attrs:{xs:24,sm:24,md:12,lg:6,xl:6}},[n("el-card",{attrs:{shadow:"hover","body-style":{padding:"0px"}}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("strong",[e._v(e._s(t.name+(2===t.online?"（已下架）":"")))]),"weight"===t.measureType?n("el-tag",{staticStyle:{float:"right"},attrs:{size:"mini",effect:"plain"}},[e._v(" 称重 ")]):n("el-tag",{staticStyle:{float:"right"},attrs:{size:"mini",type:"info",effect:"plain"}},[e._v(" 计数 ")])],1),n("div",{staticClass:"card-body",class:(2===t.online||0===t.stock)&&"disabled",on:{click:function(n){return e.addToCart(t)}}},[n("div",{staticClass:"goods-info-qrcode"},[n("span",[e._v("条码："+e._s(t.qrcode||"--"))])]),n("p",{staticClass:"goods-info-stock"},[n("span",[e._v("库存："+e._s(t.stock+(t.unit?t.unit:"")))]),n("el-input-number",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{min:0,step:1,precision:3},model:{value:t.saled,callback:function(n){e.$set(t,"saled",n)},expression:"goods.saled"}})],1),n("div",{staticClass:"bottom floatRight"},[t.priceRange?n("span",{staticClass:"price"},[e._v("￥"+e._s(e._f("priceRangeFilter")(t.priceRange)))]):n("span",{staticClass:"price"},[e._v("￥"+e._s(t.price))])])])])],1)})),1):n("el-empty",{attrs:{description:"该分类下暂无商品"}},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleClickMenu({link:"/goods/create"})}}},[e._v("去创建")])],1)],1)])})),1)],1),n("div",{staticClass:"qrcode-input"},[e.currentWeight?n("div",{staticClass:"weight-content"},[n("span",[e._v(e._s(e.currentWeight)),n("i",{staticStyle:{"font-size":"24px"}},[e._v("kg")])])]):n("el-button",{attrs:{size:"medium",type:"info"},on:{click:e.getSerialPort}},[e._v("连接电子秤")]),n("el-form",{attrs:{"label-width":"80px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.qrcodeKeyUp.apply(null,arguments)}}},[n("el-form-item",{attrs:{label:"条码输入:"}},[n("el-input",{attrs:{autofocus:"",placeholder:"请输入或扫描商品条形码,按enter键确认"},model:{value:e.searchQRcode,callback:function(t){e.searchQRcode=t},expression:"searchQRcode"}})],1)],1)],1)])])])},r=[],i=n("5530"),s=(n("4160"),n("d3b7"),n("159b"),n("4de4"),n("caad"),n("2532"),n("ac1f"),n("1276"),n("9911"),n("b0c0"),n("acd8"),n("a9e3"),n("7db0"),n("2f62")),c=n("ad8f"),o=n("fa59"),l=n("c32f"),u={mixins:[l["default"]],filters:{priceRangeFilter:function(e){e=JSON.parse(e);var t=e[0].price;return e.length>1&&(t=e[e.length-1].price+"~"+t),t}},data:function(){return{topMenuList:o["topMenuList"],searchQRcode:"",list:[],currentWeight:null,activeTypeId:""}},computed:Object(i["a"])(Object(i["a"])({},Object(s["c"])({allTypes:"classification/getAllTypes",goodsList:"goods/getGoodsList"})),{},{dataByType:function(){var e=this,t={};return this.allTypes.forEach((function(n){t[n.uuid]=e.goodsList.filter((function(e){return e.type.split(",").includes(n.uuid)}))})),t}}),watch:{allTypes:function(e){e.length&&(this.activeTypeId=this.allTypes[0].uuid)}},created:function(){this.setTypeList(),this.setGoodsList()},methods:Object(i["a"])(Object(i["a"])(Object(i["a"])({},Object(s["d"])({addCartItem:"cart/addCartItem"})),Object(s["b"])({setGoodsList:"goods/setGoodsList",setTypeList:"classification/setTypeList"})),{},{handleClickMenu:function(e){e.link?this.$router.push(e.link):console.log(e.name)},add:function(e){var t=this;Object(c["getList"])({type:e.name}).then((function(e){t.list=e.data.data}))},addToCart:function(e){if(2===e.online)return this.$baseMessage("下架商品不可销售哦！","info"),!1;if(0===e.stock)return this.$baseMessage("库存不足了哦！","error"),!1;if("weight"===e.measureType){if(!parseFloat(this.currentWeight))return void this.$baseMessage("商品重量不足或未放置商品！","error");e.saled=parseFloat(this.currentWeight||"00.000")}else e.stock-=1,e.saled=e.saled?Number(e.saled)+1:1;this.addCartItem(e)},qrcodeKeyUp:function(){var e=this,t=this.getGoodsList.find((function(t){return t.qrcode===e.searchQRcode}));t&&this.addToCart(t)}})},d=u,f=(n("85ba"),n("0c7c")),p=Object(f["a"])(d,a,r,!1,null,"45b9cef1",null);t["default"]=p.exports},"857a":function(e,t,n){var a=n("e330"),r=n("1d80"),i=n("577e"),s=/"/g,c=a("".replace);e.exports=function(e,t,n,a){var o=i(r(e)),l="<"+t;return""!==n&&(l+=" "+n+'="'+c(i(a),s,"&quot;")+'"'),l+">"+o+"</"+t+">"}},"85ba":function(e,t,n){"use strict";n("acf1")},9911:function(e,t,n){"use strict";var a=n("23e7"),r=n("857a"),i=n("af03");a({target:"String",proto:!0,forced:i("link")},{link:function(e){return r(this,"a","href",e)}})},acd8:function(e,t,n){var a=n("23e7"),r=n("7e12");a({global:!0,forced:parseFloat!=r},{parseFloat:r})},acf1:function(e,t,n){},af03:function(e,t,n){var a=n("d039");e.exports=function(e){return a((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}},c32f:function(e,t,n){"use strict";n.r(t);n("277d");function a(e){if(Array.isArray(e))return e}n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");function r(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],s=!0,c=!1;try{for(n=n.call(e);!(s=(a=n.next()).done);s=!0)if(i.push(a.value),t&&i.length===t)break}catch(o){c=!0,r=o}finally{try{s||null==n["return"]||n["return"]()}finally{if(c)throw r}}return i}}var i=n("06c5");n("d9e2"),n("d401");function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){return a(e)||r(e,t)||Object(i["a"])(e,t)||s()}var o=n("1da1");n("a630"),n("ac1f"),n("466d"),n("96cf"),t["default"]={mounted:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!("serial"in navigator)){t.next=9;break}return t.next=3,null===(n=navigator.serial)||void 0===n?void 0:n.getPorts();case 3:a=t.sent,r=c(a,1),i=r[0],i?e.connectPort(i):e.$confirm("要链接电子秤吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then(Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getSerialPort();case 1:case"end":return t.stop()}}),t)}))))["catch"]((function(){e.currentWeight="",console.log("不连接串口！")})),t.next=10;break;case 9:console.log("抱歉，当前环境不支持串口协议！");case 10:case"end":return t.stop()}}),t)})))()},methods:{connectPort:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var a,r,i,s,c,o,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=!0,r=new window.TextDecoderStream,i=r.readable.getReader(),e.readable){n.next=8;break}return n.next=6,e.open({baudRate:9600});case 6:t.$baseMessage("电子秤链接成功"),e.readable.pipeTo(r.writable);case 8:if(!e.readable||!a){n.next=28;break}return n.prev=9,n.next=12,i.read();case 12:if(s=n.sent,c=s.value,o=s.done,!o){n.next=18;break}return i.releaseLock(),n.abrupt("break",28);case 18:c&&(l=Array.from(c.match(/[0-9]+\.[0-9]+/)||[])[0],l&&t.currentWeight!==l&&(t.currentWeight=l||"00.000")),n.next=24;break;case 21:n.prev=21,n.t0=n["catch"](9),console.error(n.t0);case 24:return n.prev=24,n.finish(24);case 26:n.next=8;break;case 28:return n.next=30,e.close();case 30:console.log("port closed");case 31:case"end":return n.stop()}}),n,null,[[9,21,24,26]])})))()},getSerialPort:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,navigator.serial.requestPort();case 2:n=t.sent,e.connectPort(n);case 4:case"end":return t.stop()}}),t)})))()}}}},fa59:function(e,t,n){"use strict";n.r(t),n.d(t,"topMenuList",(function(){return a}));var a=[{name:"零售",icon:"store",link:""},{name:"新增会员",icon:"user-plus",link:"/vip/list?operate=add"},{name:"会员活动",icon:"id-card",link:"/vip/privilege"},{name:"销售查询",icon:"calendar-alt",link:"/data/order"},{name:"交接班",icon:"exchange-alt",link:""},{name:"创建商品",icon:"calendar-plus",link:"/goods/create"},{name:"库存查询",icon:"truck",link:"/goods/stock"},{name:"更多功能",icon:"th-large",link:"/goods/index"},{name:"后台管理",icon:"tv",link:"/data/analyse"},{name:"系统设置",icon:"cog",link:"/management/systemInfo"}]}}]);